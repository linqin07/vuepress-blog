(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{294:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("https://www.infoq.cn/article/analysis-of-elasticsearch-cluster-part01?utm_campaign=rightbar_v2&utm_source=infoq&utm_medium=articles_link&utm_content=link_text")]),t._v(" "),s("h4",{attrs:{id:"常见问题："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题：","aria-hidden":"true"}},[t._v("#")]),t._v(" 常见问题：")]),t._v(" "),s("ol",[s("li",[t._v("日志中出现：[FORBIDDEN/12/index read-only / allow delete (api)]")])]),t._v(" "),s("p",[t._v("这是由于 ES 新节点的数据目录 data 存储空间不足，导致从 master 主节点接收同步数据的时候失败，此时 ES 集群为了保护数据，会自动把索引分片 index 置为只读 read-only，解决好磁盘问题后执行以下命令。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -XPUT -H "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type: application/json"')]),t._v(" http://localhost:9200/_all/_settings -d "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{\"index.blocks.read_only_allow_delete\": null}'")]),t._v("\n")])])]),s("p",[t._v("2.清空索引")]),t._v(" "),s("p",[t._v("数据大就很删除要很慢")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -XPOST  -H "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type: application/json"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".32.188:9201/south_mgr_20210531/_doc/_delete_by_query -d  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ "query": { "match_all": {} } }\'')]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);