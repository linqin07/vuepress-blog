(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{480:function(a,t,s){"use strict";s.r(t);var e=s(20),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("https://www.infoq.cn/article/analysis-of-elasticsearch-cluster-part01?utm_campaign=rightbar_v2&utm_source=infoq&utm_medium=articles_link&utm_content=link_text")]),a._v(" "),t("h4",{attrs:{id:"常见问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[a._v("#")]),a._v(" 常见问题：")]),a._v(" "),t("ol",[t("li",[a._v("日志中出现：[FORBIDDEN/12/index read-only / allow delete (api)]")])]),a._v(" "),t("p",[a._v("这是由于 ES 新节点的数据目录 data 存储空间不足，导致从 master 主节点接收同步数据的时候失败，此时 ES 集群为了保护数据，会自动把索引分片 index 置为只读 read-only，解决好磁盘问题后执行以下命令。")]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XPUT")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Content-Type: application/json"')]),a._v(" http://localhost:9200/_all/_settings "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'{\"index.blocks.read_only_allow_delete\": null}'")]),a._v("\n")])])]),t("p",[a._v("2.清空索引")]),a._v(" "),t("p",[a._v("数据大就很删除要很慢")]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XPOST")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Content-Type: application/json"')]),a._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".32.188:9201/south_mgr_20210531/_doc/_delete_by_query "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{ "query": { "match_all": {} } }\'')]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);