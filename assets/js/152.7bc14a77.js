(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{547:function(t,s,a){"use strict";a.r(s);var n=a(20),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"部署到github-page"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署到github-page"}},[t._v("#")]),t._v(" 部署到github page")]),t._v(" "),s("p",[t._v("新建仓库 woshilinqin.github.io  其中前面是你 github 的用户名")]),t._v(" "),s("p",[t._v("到 vuepress 编译后的 dist 文件直接初始化 git 仓库")]),t._v(" "),s("p",[t._v("下面方式用的是 https 方式，需要验证帐号信息，除非你设置了免密。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" README.md\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first commit"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" origin git@github.com:woshilinqin/woshilinqin.github.io.git\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" origin master\n")])])]),s("p",[s("strong",[t._v("还可以使用脚本进行编译构建推送")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("在 "),s("code",[t._v("docs/.vuepress/config.js")]),t._v(" 设置正确的 "),s("code",[t._v("base")]),t._v("。")]),t._v(" "),s("p",[t._v("如果你打算部署到 "),s("code",[t._v("https://<USERNAME>.github.io/")]),t._v("，就可以省略这一步，因为 "),s("code",[t._v("base")]),t._v(" 默认为 "),s("code",[t._v('"/"')]),t._v("。")]),t._v(" "),s("p",[t._v("如果你打算部署到 "),s("code",[t._v("https://<USERNAME>.github.io/<REPO>/")]),t._v("（也就是说你的仓库地址是 "),s("code",[t._v("https://github.com/<USERNAME>/<REPO>")]),t._v("），设置 base 为 "),s("code",[t._v('"/<REPO>/"')]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("在你的项目中，创建一个有以下内容的 "),s("code",[t._v("deploy.sh")]),t._v(" 文件（对高亮行适当注释），然后运行它完成部署：")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env sh")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 终止一个错误")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run docs:build\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入生成的构建文件夹")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" docs/.vuepress/dist\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你是要部署到自定义域名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo 'www.example.com' > CNAME")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deploy'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你想要部署到 https://<USERNAME>.github.io")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push -f git@github.com:<USERNAME>/<USERNAME>.github.io.git master")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你想要部署到 https://<USERNAME>.github.io/<REPO>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" git@github.com:woshilinqin/document.git master:gh-pages\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" -\n")])])]),s("blockquote",[s("p",[t._v("这里的 document 为仓库名称，并且 base 已经设置为 "),s("code",[t._v("base: '/document'")]),t._v("，除此之外，git 也已经生成好了 ssh 密钥，并且关联 github 帐号添加了 ssh key。我这里分两个仓库，一个仓库记录博客源码，另一个仓库 document 部署编译后的静态页面。当然也可以使用同一个仓库不同分支来实现。")])]),t._v(" "),s("p",[t._v("然后在 package.json 里面增加 "),s("code",[t._v('"deploy" : "bash deploy.sh"')]),t._v("，命令行执行 "),s("strong",[t._v("npm run deploy")]),t._v(" 触发编译构建上传。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com"')]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"description"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"index.js"')]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docs:dev"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress dev docs"')]),t._v(",\n\t\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docs:build"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress build docs"')]),t._v(",\n\t\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deploy"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bash deploy.sh"')]),t._v("\n\t\t\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"author"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(",\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"license"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ISC"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"自动化构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动化构建"}},[t._v("#")]),t._v(" 自动化构建")]),t._v(" "),s("h4",{attrs:{id:"方案一-使用-travis-已收费"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案一-使用-travis-已收费"}},[t._v("#")]),t._v(" 方案一：使用 Travis（已收费）")]),t._v(" "),s("p",[t._v("首先进入 "),s("a",{attrs:{href:"https://travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("travis-ci 官网"),s("OutboundLink")],1),t._v("，使用 github 帐号登录，将对应的项目启用 "),s("code",[t._v("Travis CI")]),t._v(" ：")]),t._v(" "),s("ol",[s("li",[t._v("首先先在 github 仓库设置获取 personnal access token")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1562226911308.png",alt:"1562226911308.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1562227005634.png",alt:"1562227005634.png"}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("将生成的 "),s("strong",[t._v("token")]),t._v(" 放入 Travis 环境变量中。")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1562227192867.png",alt:"1562227192867.png"}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("项目跟目录添加 .travis.yml")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node_js")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" lts/*\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 缓存目录，加速编译")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("directories")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node_modules\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初始化环境")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm install "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("g vuepress\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("before_script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chmod a+x deploy.sh\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" bash ./deploy.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#deploy:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  provider: pages")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  skip-cleanup: true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  local_dir: docs/.vuepress/dist")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#  github-token: "${access_token}"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  keep-history: true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  on:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    branch: gh-pages")]),t._v("\n\n")])])]),s("p",[t._v("其中对应的 deploy.sh 脚本内容如下:")]),t._v(" "),s("p",[t._v("这里的 access_token 对应 travis 网站上设置的环境变量名称。git 推送地址使用 http 形式，使用 ssh 的形式会报错没有权限。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env sh")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 终止一个错误")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run docs:build\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入生成的构建文件夹")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" docs/.vuepress/dist\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你是要部署到自定义域名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo 'www.example.com' > CNAME")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deploy'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你想要部署到 https://<USERNAME>.github.io")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push -f git@github.com:<USERNAME>/<USERNAME>.github.io.git master")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ssh推送，如果你想要部署到 https://<USERNAME>.github.io/<REPO>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push -f git@github.com:woshilinqin/document.git master:gh-pages")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http推送")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git push -f https://github.com/woshilinqin/document.git master:gh-pages")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http推送,travis-ci自动化,")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" https://"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${access_token}")]),t._v("@github.com/woshilinqin/document.git master:gh-pages\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" -\n")])])])])]),t._v(" "),s("h5",{attrs:{id:"如何跳过自动构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何跳过自动构建"}},[t._v("#")]),t._v(" 如何跳过自动构建")]),t._v(" "),s("p",[t._v("如果 commit 不想让 Travis 构建，那么就在 commit message 里加上 [ci skip] 就行了。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[ci skip] commit message "')]),t._v("\n")])])]),s("h4",{attrs:{id:"方案二-使用-github-action"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案二-使用-github-action"}},[t._v("#")]),t._v(" 方案二：使用 Github-Action")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://docs.github.com/zh/actions/quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网文档"),s("OutboundLink")],1)]),t._v(" "),s("ol",[s("li",[t._v("Create a "),s("code",[t._v(".github/workflows")]),t._v(" directory in your repository on GitHub if this directory does not already exist.")]),t._v(" "),s("li",[t._v("In the "),s("code",[t._v(".github/workflows")]),t._v(" directory, create a file named "),s("code",[t._v("github-actions-demo.yml")]),t._v('. For more information, see "'),s("a",{attrs:{href:"https://docs.github.com/en/repositories/working-with-files/managing-files/creating-new-files",target:"_blank",rel:"noopener noreferrer"}},[t._v("Creating new files"),s("OutboundLink")],1),t._v('."')]),t._v(" "),s("li",[t._v("Copy the following YAML contents into the "),s("code",[t._v("github-actions-demo.yml")]),t._v(" file:")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 博客发布\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout master\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup node\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node@v1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"16.x"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm install\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm run docs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("build\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" echo 'linqin.site' "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" ./docs/.vuepress/dist/CNAME\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build project\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peaceiris/actions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("github_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("secrets.access_token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./docs/.vuepress/dist\n\n")])])]),s("p",[t._v("name 为 action 名称")]),t._v(" "),s("p",[t._v("on.push 表示 push 的时候出发，并指定分支")]),t._v(" "),s("p",[t._v("job 里面的 step 表示步骤")]),t._v(" "),s("p",[t._v("每个 steps 里面是一项项的动作，name 注释可有可无， uses 可以引用"),s("a",{attrs:{href:"https://github.com/marketplace?type=actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方的轮子"),s("OutboundLink")],1),t._v("，run是表示执行的命令，注意执行目录都是 master")]),t._v(" "),s("p",[t._v("当前目录。")]),t._v(" "),s("p",[t._v("可以在 Actions 里面看到自己的工作流。")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/image-20231022163427124.png",alt:"image-20231022163427124"}}),t._v(" "),s("blockquote",[s("p",[t._v("需要注意的是，不管是 run 里面的密钥，还是轮子使用到的密钥，都可以使用引用变量的方式替换，防止 public 暴露。")]),t._v(" "),s("p",[s("strong",[t._v("新建变量")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("新建个人token，个人设置 -> 开发者选项 Personal access tokens ->  tokens (classic) ，创建后")])]),t._v(" "),s("li",[s("p",[t._v("仓库设置，配置对应的变量名称，值就是个人token\n"),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/image-20231022163951318.png",alt:"image-20231022163951318"}})])]),t._v(" "),s("li",[s("p",[t._v("引用方式，可以 run 直接引用，或者是轮子引用。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("${{secrets.SECRET_KEY}}\n")])])])])])]),t._v(" "),s("h3",{attrs:{id:"发布到自定义域名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布到自定义域名"}},[t._v("#")]),t._v(" 发布到自定义域名")]),t._v(" "),s("p",[t._v("首先，先去"),s("a",{attrs:{href:"https://wanwang.aliyun.com/?spm=5176.12825654.eofdhaal5.70.38142c4aWVmXFl",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云"),s("OutboundLink")],1),t._v("买个域名，可以在控制台找到自己的域名，新增解析。新增解析记录。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1564763403762.png",alt:"1564763403762.png"}})]),t._v(" "),s("p",[t._v("​")]),t._v(" "),s("p",[t._v("​       发布脚本增加")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果是发布到自定义域名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'www.linqin.site'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" CNAME\n")])])]),s("p",[t._v("注意：由于记录值为 "),s("code",[t._v("xxx.github.io")]),t._v("，所以文档的 "),s("code",[t._v("base")]),t._v("必须为 "),s("code",[t._v("/")]),t._v("，具体请见"),s("a",{attrs:{href:"https://www.vuepress.cn/guide/deploy.html#github-%E9%A1%B5%E9%9D%A2",target:"_blank",rel:"noopener noreferrer"}},[t._v("部署教程 > Github 页面"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("发布不能实时刷新，GitHub有时区延迟正常，过8小时再看即可。")])])}),[],!1,null,null,null);s.default=e.exports}}]);