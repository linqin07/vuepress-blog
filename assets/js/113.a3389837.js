(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{338:function(e,t,a){"use strict";a.r(t);var s=a(2),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"zookeeper的安装使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper的安装使用","aria-hidden":"true"}},[e._v("#")]),e._v(" zookeeper的安装使用")]),e._v(" "),a("h4",{attrs:{id:"_1-下载zookeeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载zookeeper","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.下载zookeeper")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://archive.apache.org/dist/zookeeper/zookeeper-3.3.6/zookeeper-3.3.6.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[e._v("点击下载"),a("OutboundLink")],1)]),e._v(" "),a("h4",{attrs:{id:"_2-解压修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-解压修改配置","aria-hidden":"true"}},[e._v("#")]),e._v(" 2.解压修改配置")]),e._v(" "),a("p",[e._v("我们进入到conf文件夹下面，将zoo_sample.cfg这个文件复制为zoo.cfg，必须是这个名字\n加上配置：")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("dataDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/tmp/zookeeper\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("dataLogDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/tmp/zookeeper/log\n")])])]),a("p",[e._v("前者表示数据文件，后者是日志，也可以修改一下默认端口。")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1551085560519.png",alt:"1551085560519.png"}})]),e._v(" "),a("p",[a("strong",[e._v("添加环境变量")]),e._v("：")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("vim /etc/profile")])])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://blog-07.oss-cn-guangzhou.aliyuncs.com/picBak/1551087006708.png",alt:"1551087006708.png"}})]),e._v(" "),a("blockquote",[a("p",[e._v("重载：source /etc/profile\n查看：echo $PATH")])]),e._v(" "),a("p",[a("strong",[e._v("启动")]),e._v("：bin目录下")]),e._v(" "),a("blockquote",[a("p",[e._v("启动   ./zkServer.sh start\n看状态 ./zkServer.sh status\n看日志 cat zookeeper.out\n启动客户端：./zkCli.sh")])]),e._v(" "),a("h4",{attrs:{id:"集群配置："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群配置：","aria-hidden":"true"}},[e._v("#")]),e._v(" 集群配置：")]),e._v(" "),a("p",[e._v("如果你是集群的话，请在clientPort下面添加服务器的ip。如\n集群配置：在zookeeper目录下，创建data目录，对应"),a("code",[e._v("dataDir")]),e._v("配置。在3个zookeeper节点中data目录下分别创建mypid[^1]")]),e._v(" "),a("p",[e._v("[^1]: echo 1 >/tmp/mypid")]),e._v(" "),a("p",[e._v("文件，并分别添加内容0、1、2等。识别哪个机器")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("server.1"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".180.132:2888:3888\nserver.2"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".180.133:2888:3888\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("blockquote",[a("p",[e._v("server.A=B：C：D：其中 A 是一个数字，表示这个是第几号服务器；B 是这个服务器的 ip 地址；C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口")])]),e._v(" "),a("h3",{attrs:{id:"伪集群配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#伪集群配置","aria-hidden":"true"}},[e._v("#")]),e._v(" 伪集群配置")]),e._v(" "),a("p",[e._v("就是一个机器上运行多个 zookeeper，开发环境节约资源。复制 3 份 zookeeper 文件夹。")]),e._v(" "),a("p",[e._v("文件夹分别命名为 zookeeper1、zookeeper2、zookeeper3。")]),e._v(" "),a("p",[e._v("zookeeper 配置 zoo.cfg 修改端口值、数据路径、以及数据路径下的 myid 值。")]),e._v(" "),a("p",[e._v("zookeeper1 的配置文件示例：")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 心跳时间间隔")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("tickTime")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2000")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 集群中，客户端初始化连接时间，以tickTime为单位，超过就链接失败")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("initLimit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 集群机器应答时间，以tickTime为单位")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("syncLimit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 数据目录")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("dataDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/data/zookeeper1/data\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# the port at which the clients will connect")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("clientPort")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2181")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 客户端最大连接数")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#maxClientCnxns=60")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 需要保留的快照数目")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#autopurge.snapRetainCount=3")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 是否开启自动清理事务日志和快照功能 0 不开启，1表示开启")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#autopurge.purgeInterval=1")]),e._v("\n\nserver.1"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".152.128:2881:3881\nserver.2"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".152.128:2882:3882\nserver.3"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".152.128:2883:3883\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);