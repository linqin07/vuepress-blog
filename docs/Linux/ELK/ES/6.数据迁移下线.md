### 删除es节点

1. 迁移分片

   填写对应的下线机器 ip

   ```sh
   PUT _cluster/settings
   {
     "transient" : {
       "cluster.routing.allocation.exclude._ip" : “10.0.0.1,10.0.0.2"
     }
   }
   ```

   完整命令

   ```sh
   curl -k -u 'admin:admin!@#' -XPUT  https://172.28.50.200:9200/_cluster/settings -d '{"transient":{"cluster.routing.allocation.exclude._ip":"172.29.50.131,172.29.50.129,172.29.50.132,172.29.50.127,172.29.50.134,172.29.50.133,172.29.50.128"}}
   
   ```

2. 查看迁移进度：
   get _cat/allocation?v

3. 下线完成后重新设置一下路由为空

   ```sh
   PUT _cluster/settings
   {
     "transient" : {
       "cluster.routing.allocation.exclude._ip" : ""
     }
   }
   ```

   其中 ip 不填。

