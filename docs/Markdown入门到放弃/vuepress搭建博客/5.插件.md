# 添加PWA

当网站更新（即 Service Worker 更新）时，它会提供一个 refresh 按钮，允许用户立刻刷新内容。其次，必须是HTTPS才可以，我们部署到 GitHub Page 刚好是可以的。详细参考[官方文档](https://v1.vuepress.vuejs.org/plugin/official/plugin-pwa.html)。

##### 1. package.json

vuepress 版本

```json
{
	"name": "com",
	"version": "1.0.0",
	"description": "",
	"main": "index.js",
	"scripts": {
		"docs:dev": "vuepress dev docs",
		"docs:build": "vuepress build docs",
		"deploy": "bash deploy.sh",
		"create": "bash createCatalog.sh"
	},
	"author": "LinQin",
	"license": "ISC",
	"devDependencies": {
		"@vuepress/plugin-back-to-top": "^1.0.2",
		"@vuepress/plugin-google-analytics": "^1.0.2",
		"@vuepress/plugin-pwa": "^1.0.2",
		"vuepress": "^1.0.2"
	}
}
```

##### 2. config.js

```vue
module.exports = {
    plugins:{
    '@vuepress/back-to-top': true,
    // '@vuepress/medium-zoom': true,
    '@vuepress/pwa': {
        serviceWorker: true,
        updatePopup: {
            message: "啦啦啦,一大波内容已更新!",
            buttonText: "朕知道了"
        }
    }
}
}
```

##### public文件夹下新建`manifest.json`

```json
{
    "name": "fog3211",
    "short_name": "任庆忠",
    "start_url": ".",
    "display": "standalone",
    "background_color": "#2196f3",
    "description": "任庆忠的个人博客",
    "theme_color": "#FFCC33",
    "icons": [
      {
        "src": "./favicon.ico",
        "sizes": "32x32",
        "type": "image/x-icon"
      }
    ],
    "related_applications": [
      {
        "platform": "web",
        "url": ""
      },
      {
        "platform": "play",
        "url": "https://play.google.com/store/apps/details?id=cheeaun.hackerweb"
      }
    ]
  }
```

可以参考[这里](https://app-manifest.firebaseapp.com/)生成对应的 `manifest.json`以及图片。复制到 `public`文件夹下面，并且修改一下图片的相对路径。其他还有很多

##### [#](https://fog3211.com/blog/vuepress-blog.html#%E5%BC%80%E5%90%AF%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8pwa)3. 开启谷歌浏览器PWA

在Chrome浏览器地址栏输入

```bash
Chrome://flags
```

搜索 pwa，并将状态改成`Enabled`，并重启浏览器

![chrome打开pwa](https://img.fog3211.com/5L7I%292$70U%28O~K_~55%25%5B%7D6T.png)

然后点击`自定义及控制按钮`（就是右上角的那个三个点的图标），然后点击`创建快捷方式`即可。

##### 4. GitHub Page 打开 HTTPS 

> Enforce HTTPS 
> HTTPS provides a layer of encryption that prevents others from snooping on or tampering with traffic to your site.
> When HTTPS is enforced, your site will only be served over HTTPS. Learn more.

