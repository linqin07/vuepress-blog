<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.设置docker加速、运行http访问、远程访问</title>
    <meta name="description" content="">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" href="/favicon-32x32.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.3fb8bf05.css" as="style"><link rel="preload" href="/assets/js/app.8835c5f3.js" as="script"><link rel="preload" href="/assets/js/3.f34275aa.js" as="script"><link rel="preload" href="/assets/js/98.bc5c7835.js" as="script"><link rel="preload" href="/assets/js/4.886c8c49.js" as="script"><link rel="prefetch" href="/assets/js/10.cfaa7ef9.js"><link rel="prefetch" href="/assets/js/100.a1c6ecfa.js"><link rel="prefetch" href="/assets/js/101.99a15943.js"><link rel="prefetch" href="/assets/js/102.b3bf3e62.js"><link rel="prefetch" href="/assets/js/103.7424a647.js"><link rel="prefetch" href="/assets/js/104.d108d57c.js"><link rel="prefetch" href="/assets/js/105.b11ce750.js"><link rel="prefetch" href="/assets/js/106.13ab23d9.js"><link rel="prefetch" href="/assets/js/107.5909b987.js"><link rel="prefetch" href="/assets/js/108.ba9172af.js"><link rel="prefetch" href="/assets/js/109.3792f43f.js"><link rel="prefetch" href="/assets/js/11.5af1bf95.js"><link rel="prefetch" href="/assets/js/110.b6f7a417.js"><link rel="prefetch" href="/assets/js/111.bbbf8693.js"><link rel="prefetch" href="/assets/js/112.e9d0cef8.js"><link rel="prefetch" href="/assets/js/113.a3389837.js"><link rel="prefetch" href="/assets/js/114.25893466.js"><link rel="prefetch" href="/assets/js/115.c02892b3.js"><link rel="prefetch" href="/assets/js/116.e49fa73c.js"><link rel="prefetch" href="/assets/js/117.b266d267.js"><link rel="prefetch" href="/assets/js/118.133f1021.js"><link rel="prefetch" href="/assets/js/119.3fb9390b.js"><link rel="prefetch" href="/assets/js/12.74f33bb6.js"><link rel="prefetch" href="/assets/js/120.1f6a0358.js"><link rel="prefetch" href="/assets/js/121.a8d167a4.js"><link rel="prefetch" href="/assets/js/122.3e0ad8d0.js"><link rel="prefetch" href="/assets/js/123.ea3cb237.js"><link rel="prefetch" href="/assets/js/124.c3bb228f.js"><link rel="prefetch" href="/assets/js/125.9036b9f0.js"><link rel="prefetch" href="/assets/js/126.250494ae.js"><link rel="prefetch" href="/assets/js/127.e647aee3.js"><link rel="prefetch" href="/assets/js/128.b25e7878.js"><link rel="prefetch" href="/assets/js/129.95815bcb.js"><link rel="prefetch" href="/assets/js/13.f93a8063.js"><link rel="prefetch" href="/assets/js/130.67978a9c.js"><link rel="prefetch" href="/assets/js/131.76b34278.js"><link rel="prefetch" href="/assets/js/132.79fc2dd0.js"><link rel="prefetch" href="/assets/js/133.34d3bb89.js"><link rel="prefetch" href="/assets/js/134.e0b4790c.js"><link rel="prefetch" href="/assets/js/135.b836f360.js"><link rel="prefetch" href="/assets/js/136.21b47181.js"><link rel="prefetch" href="/assets/js/137.f05f050b.js"><link rel="prefetch" href="/assets/js/138.5e1f7ca9.js"><link rel="prefetch" href="/assets/js/139.38ea3767.js"><link rel="prefetch" href="/assets/js/14.3490d1ab.js"><link rel="prefetch" href="/assets/js/140.3ac611e9.js"><link rel="prefetch" href="/assets/js/141.71806155.js"><link rel="prefetch" href="/assets/js/142.f3af7c8c.js"><link rel="prefetch" href="/assets/js/143.ab9398f9.js"><link rel="prefetch" href="/assets/js/144.b237087f.js"><link rel="prefetch" href="/assets/js/145.e4500586.js"><link rel="prefetch" href="/assets/js/146.69b4202e.js"><link rel="prefetch" href="/assets/js/147.8e75988b.js"><link rel="prefetch" href="/assets/js/148.40515cbc.js"><link rel="prefetch" href="/assets/js/149.abe0175c.js"><link rel="prefetch" href="/assets/js/15.16b83199.js"><link rel="prefetch" href="/assets/js/150.dbc43065.js"><link rel="prefetch" href="/assets/js/151.28a2fbcf.js"><link rel="prefetch" href="/assets/js/152.33d20a6a.js"><link rel="prefetch" href="/assets/js/153.47bb35db.js"><link rel="prefetch" href="/assets/js/154.7c7db563.js"><link rel="prefetch" href="/assets/js/155.20f74f3b.js"><link rel="prefetch" href="/assets/js/156.dd8dde80.js"><link rel="prefetch" href="/assets/js/157.ac6667c5.js"><link rel="prefetch" href="/assets/js/158.4d26f2df.js"><link rel="prefetch" href="/assets/js/159.d822ebe9.js"><link rel="prefetch" href="/assets/js/16.dd637b0f.js"><link rel="prefetch" href="/assets/js/160.38f2e4e2.js"><link rel="prefetch" href="/assets/js/161.8832085b.js"><link rel="prefetch" href="/assets/js/162.52a6f7d7.js"><link rel="prefetch" href="/assets/js/163.9c37c53b.js"><link rel="prefetch" href="/assets/js/164.71bcf1ef.js"><link rel="prefetch" href="/assets/js/165.93cea98f.js"><link rel="prefetch" href="/assets/js/166.5fcf050a.js"><link rel="prefetch" href="/assets/js/167.6f193c19.js"><link rel="prefetch" href="/assets/js/168.5b2939b3.js"><link rel="prefetch" href="/assets/js/169.bb967ea8.js"><link rel="prefetch" href="/assets/js/17.cf5f4f43.js"><link rel="prefetch" href="/assets/js/170.6c6afccc.js"><link rel="prefetch" href="/assets/js/171.89d98cf8.js"><link rel="prefetch" href="/assets/js/172.e1a4f393.js"><link rel="prefetch" href="/assets/js/173.a5206bc9.js"><link rel="prefetch" href="/assets/js/174.9f042e8a.js"><link rel="prefetch" href="/assets/js/175.d9643390.js"><link rel="prefetch" href="/assets/js/176.22627301.js"><link rel="prefetch" href="/assets/js/177.f14c94de.js"><link rel="prefetch" href="/assets/js/178.cdd4776c.js"><link rel="prefetch" href="/assets/js/179.eda5ab63.js"><link rel="prefetch" href="/assets/js/18.cfa7767c.js"><link rel="prefetch" href="/assets/js/180.5fde3cf3.js"><link rel="prefetch" href="/assets/js/181.42a3a08a.js"><link rel="prefetch" href="/assets/js/182.539fa13d.js"><link rel="prefetch" href="/assets/js/183.e85f7a49.js"><link rel="prefetch" href="/assets/js/184.3d9bcf27.js"><link rel="prefetch" href="/assets/js/185.8bbe61cb.js"><link rel="prefetch" href="/assets/js/186.dc6a5458.js"><link rel="prefetch" href="/assets/js/187.69f6a00e.js"><link rel="prefetch" href="/assets/js/188.234896c6.js"><link rel="prefetch" href="/assets/js/189.66734710.js"><link rel="prefetch" href="/assets/js/19.d8896581.js"><link rel="prefetch" href="/assets/js/190.f5b0fd08.js"><link rel="prefetch" href="/assets/js/191.4ee3f850.js"><link rel="prefetch" href="/assets/js/192.fd467eb1.js"><link rel="prefetch" href="/assets/js/193.bcd0a188.js"><link rel="prefetch" href="/assets/js/194.e1020420.js"><link rel="prefetch" href="/assets/js/195.e0f2099a.js"><link rel="prefetch" href="/assets/js/196.74133e04.js"><link rel="prefetch" href="/assets/js/197.8b57af75.js"><link rel="prefetch" href="/assets/js/198.5afe77a3.js"><link rel="prefetch" href="/assets/js/199.0ba0b14a.js"><link rel="prefetch" href="/assets/js/20.903827e1.js"><link rel="prefetch" href="/assets/js/200.74e88df9.js"><link rel="prefetch" href="/assets/js/201.947b993e.js"><link rel="prefetch" href="/assets/js/202.35bbcbd6.js"><link rel="prefetch" href="/assets/js/203.948c9d9d.js"><link rel="prefetch" href="/assets/js/204.b485d493.js"><link rel="prefetch" href="/assets/js/205.026b1c91.js"><link rel="prefetch" href="/assets/js/206.f8a4c012.js"><link rel="prefetch" href="/assets/js/207.5306e987.js"><link rel="prefetch" href="/assets/js/208.5323cdd1.js"><link rel="prefetch" href="/assets/js/209.56d1940b.js"><link rel="prefetch" href="/assets/js/21.e15bdc74.js"><link rel="prefetch" href="/assets/js/210.37582de9.js"><link rel="prefetch" href="/assets/js/211.52b30765.js"><link rel="prefetch" href="/assets/js/212.7a146d8b.js"><link rel="prefetch" href="/assets/js/213.217c6b43.js"><link rel="prefetch" href="/assets/js/214.4bda5bb3.js"><link rel="prefetch" href="/assets/js/215.344733ee.js"><link rel="prefetch" href="/assets/js/216.a18eca4d.js"><link rel="prefetch" href="/assets/js/217.a16841c5.js"><link rel="prefetch" href="/assets/js/218.d1a4982d.js"><link rel="prefetch" href="/assets/js/219.86eb4011.js"><link rel="prefetch" href="/assets/js/22.bfbc2432.js"><link rel="prefetch" href="/assets/js/220.39d353ce.js"><link rel="prefetch" href="/assets/js/221.8a6bc65f.js"><link rel="prefetch" href="/assets/js/222.be38e16e.js"><link rel="prefetch" href="/assets/js/223.6d4c71f6.js"><link rel="prefetch" href="/assets/js/224.6e531d5b.js"><link rel="prefetch" href="/assets/js/225.4648e216.js"><link rel="prefetch" href="/assets/js/226.e099ff58.js"><link rel="prefetch" href="/assets/js/227.dfa7e0d7.js"><link rel="prefetch" href="/assets/js/228.9d2c5c34.js"><link rel="prefetch" href="/assets/js/229.01b7ccc2.js"><link rel="prefetch" href="/assets/js/23.84e8001d.js"><link rel="prefetch" href="/assets/js/230.c878f999.js"><link rel="prefetch" href="/assets/js/231.a8d668bd.js"><link rel="prefetch" href="/assets/js/232.5ff6dd46.js"><link rel="prefetch" href="/assets/js/233.353fcaa8.js"><link rel="prefetch" href="/assets/js/234.6fb79555.js"><link rel="prefetch" href="/assets/js/235.794d19a1.js"><link rel="prefetch" href="/assets/js/236.87865580.js"><link rel="prefetch" href="/assets/js/237.bcaf52c0.js"><link rel="prefetch" href="/assets/js/238.327f0b75.js"><link rel="prefetch" href="/assets/js/239.d2b8f67a.js"><link rel="prefetch" href="/assets/js/24.9908f461.js"><link rel="prefetch" href="/assets/js/240.0de73d24.js"><link rel="prefetch" href="/assets/js/241.d0e1f98b.js"><link rel="prefetch" href="/assets/js/242.b5289dcf.js"><link rel="prefetch" href="/assets/js/243.cc4b2b12.js"><link rel="prefetch" href="/assets/js/244.dff32c31.js"><link rel="prefetch" href="/assets/js/245.cd05abc3.js"><link rel="prefetch" href="/assets/js/246.46b3499e.js"><link rel="prefetch" href="/assets/js/247.7c435e8e.js"><link rel="prefetch" href="/assets/js/248.186017b8.js"><link rel="prefetch" href="/assets/js/249.33a55d76.js"><link rel="prefetch" href="/assets/js/25.d0182fc2.js"><link rel="prefetch" href="/assets/js/250.d030dd85.js"><link rel="prefetch" href="/assets/js/251.ae91381d.js"><link rel="prefetch" href="/assets/js/252.c483c1b6.js"><link rel="prefetch" href="/assets/js/253.5871d84a.js"><link rel="prefetch" href="/assets/js/254.0e390bb3.js"><link rel="prefetch" href="/assets/js/255.d0ea205d.js"><link rel="prefetch" href="/assets/js/256.5ad3f6f1.js"><link rel="prefetch" href="/assets/js/257.61fbdf24.js"><link rel="prefetch" href="/assets/js/258.f765e8a4.js"><link rel="prefetch" href="/assets/js/259.cd02cde1.js"><link rel="prefetch" href="/assets/js/26.94385f49.js"><link rel="prefetch" href="/assets/js/260.ab2db7d6.js"><link rel="prefetch" href="/assets/js/261.929c0202.js"><link rel="prefetch" href="/assets/js/262.8d4979c7.js"><link rel="prefetch" href="/assets/js/263.4e4bd79d.js"><link rel="prefetch" href="/assets/js/264.54efda56.js"><link rel="prefetch" href="/assets/js/265.52bae0f2.js"><link rel="prefetch" href="/assets/js/266.6be5b177.js"><link rel="prefetch" href="/assets/js/267.b3ebc614.js"><link rel="prefetch" href="/assets/js/268.50777538.js"><link rel="prefetch" href="/assets/js/269.9fa9496a.js"><link rel="prefetch" href="/assets/js/27.c8ebe6df.js"><link rel="prefetch" href="/assets/js/270.676f9f00.js"><link rel="prefetch" href="/assets/js/271.ff8dd943.js"><link rel="prefetch" href="/assets/js/272.3ed59887.js"><link rel="prefetch" href="/assets/js/273.3d2bce12.js"><link rel="prefetch" href="/assets/js/274.963ec499.js"><link rel="prefetch" href="/assets/js/275.cbb9ca22.js"><link rel="prefetch" href="/assets/js/276.839cf39c.js"><link rel="prefetch" href="/assets/js/277.6370e421.js"><link rel="prefetch" href="/assets/js/278.223d8556.js"><link rel="prefetch" href="/assets/js/279.63399f23.js"><link rel="prefetch" href="/assets/js/28.79a1f8ba.js"><link rel="prefetch" href="/assets/js/280.fa0c58cf.js"><link rel="prefetch" href="/assets/js/281.164b7774.js"><link rel="prefetch" href="/assets/js/282.c348d4cb.js"><link rel="prefetch" href="/assets/js/283.a37bf06d.js"><link rel="prefetch" href="/assets/js/284.44e226b1.js"><link rel="prefetch" href="/assets/js/285.412922d1.js"><link rel="prefetch" href="/assets/js/286.df4dc4f1.js"><link rel="prefetch" href="/assets/js/287.5377c938.js"><link rel="prefetch" href="/assets/js/288.f06f885e.js"><link rel="prefetch" href="/assets/js/289.490b03c6.js"><link rel="prefetch" href="/assets/js/29.979191e8.js"><link rel="prefetch" href="/assets/js/290.32a6a04c.js"><link rel="prefetch" href="/assets/js/291.e31c0020.js"><link rel="prefetch" href="/assets/js/292.6fda0d93.js"><link rel="prefetch" href="/assets/js/30.e2f297cf.js"><link rel="prefetch" href="/assets/js/31.dec85d9e.js"><link rel="prefetch" href="/assets/js/32.7aa977e1.js"><link rel="prefetch" href="/assets/js/33.2125b0cc.js"><link rel="prefetch" href="/assets/js/34.58f073c4.js"><link rel="prefetch" href="/assets/js/35.3667de06.js"><link rel="prefetch" href="/assets/js/36.b57b352a.js"><link rel="prefetch" href="/assets/js/37.0b546e0a.js"><link rel="prefetch" href="/assets/js/38.598836da.js"><link rel="prefetch" href="/assets/js/39.edc94eb8.js"><link rel="prefetch" href="/assets/js/40.36eee6a2.js"><link rel="prefetch" href="/assets/js/41.205768c9.js"><link rel="prefetch" href="/assets/js/42.a9bd1ceb.js"><link rel="prefetch" href="/assets/js/43.850d9cf5.js"><link rel="prefetch" href="/assets/js/44.9b737650.js"><link rel="prefetch" href="/assets/js/45.3ec4684b.js"><link rel="prefetch" href="/assets/js/46.a021ae77.js"><link rel="prefetch" href="/assets/js/47.4e380981.js"><link rel="prefetch" href="/assets/js/48.bf993652.js"><link rel="prefetch" href="/assets/js/49.56eeea5d.js"><link rel="prefetch" href="/assets/js/5.ecea56d9.js"><link rel="prefetch" href="/assets/js/50.e8befda1.js"><link rel="prefetch" href="/assets/js/51.01d54e2f.js"><link rel="prefetch" href="/assets/js/52.ebd539c8.js"><link rel="prefetch" href="/assets/js/53.7cbf2193.js"><link rel="prefetch" href="/assets/js/54.f517d59d.js"><link rel="prefetch" href="/assets/js/55.87d70171.js"><link rel="prefetch" href="/assets/js/56.e63e0e41.js"><link rel="prefetch" href="/assets/js/57.67a0ad34.js"><link rel="prefetch" href="/assets/js/58.77d36d6f.js"><link rel="prefetch" href="/assets/js/59.1a895105.js"><link rel="prefetch" href="/assets/js/6.dfb6d442.js"><link rel="prefetch" href="/assets/js/60.3dfd41f0.js"><link rel="prefetch" href="/assets/js/61.e19b8f0c.js"><link rel="prefetch" href="/assets/js/62.24b56923.js"><link rel="prefetch" href="/assets/js/63.ace6b347.js"><link rel="prefetch" href="/assets/js/64.d9ced84b.js"><link rel="prefetch" href="/assets/js/65.e2e120d4.js"><link rel="prefetch" href="/assets/js/66.020b95fc.js"><link rel="prefetch" href="/assets/js/67.bb9ce09d.js"><link rel="prefetch" href="/assets/js/68.0fa235f3.js"><link rel="prefetch" href="/assets/js/69.f61d0440.js"><link rel="prefetch" href="/assets/js/7.556ad992.js"><link rel="prefetch" href="/assets/js/70.0e5ca21b.js"><link rel="prefetch" href="/assets/js/71.780a8a2c.js"><link rel="prefetch" href="/assets/js/72.13a5fa76.js"><link rel="prefetch" href="/assets/js/73.0dc99108.js"><link rel="prefetch" href="/assets/js/74.794faa57.js"><link rel="prefetch" href="/assets/js/75.b33ac5f2.js"><link rel="prefetch" href="/assets/js/76.d45aede9.js"><link rel="prefetch" href="/assets/js/77.095b4d7b.js"><link rel="prefetch" href="/assets/js/78.1d727573.js"><link rel="prefetch" href="/assets/js/79.6dd1aa74.js"><link rel="prefetch" href="/assets/js/8.ee3f3063.js"><link rel="prefetch" href="/assets/js/80.32ed96dc.js"><link rel="prefetch" href="/assets/js/81.0a0693c1.js"><link rel="prefetch" href="/assets/js/82.bc494014.js"><link rel="prefetch" href="/assets/js/83.df139ed1.js"><link rel="prefetch" href="/assets/js/84.3c8c80ca.js"><link rel="prefetch" href="/assets/js/85.416c6e6e.js"><link rel="prefetch" href="/assets/js/86.08ab04c8.js"><link rel="prefetch" href="/assets/js/87.bb11f073.js"><link rel="prefetch" href="/assets/js/88.d9f1f64b.js"><link rel="prefetch" href="/assets/js/89.f3977300.js"><link rel="prefetch" href="/assets/js/9.8a1ba1cf.js"><link rel="prefetch" href="/assets/js/90.bb02cf7d.js"><link rel="prefetch" href="/assets/js/91.5647dd77.js"><link rel="prefetch" href="/assets/js/92.8f3f32ad.js"><link rel="prefetch" href="/assets/js/93.0921130d.js"><link rel="prefetch" href="/assets/js/94.611c7d39.js"><link rel="prefetch" href="/assets/js/95.f11a0c2d.js"><link rel="prefetch" href="/assets/js/96.468fc689.js"><link rel="prefetch" href="/assets/js/97.c4142258.js"><link rel="prefetch" href="/assets/js/99.73711a39.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.14d84a8f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3fb8bf05.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="" class="logo"> <!----></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring技术</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Spring/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/Spring-boot/" class="nav-link">Spring-boot</a></li><li class="dropdown-subitem"><a href="/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">mysql</a></li></ul></li><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link router-link-active">Linux</a></li></ul></li><li class="dropdown-item"><h4>Other</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Java学习/" class="nav-link">Java学习</a></li><li class="dropdown-subitem"><a href="/Markdown入门到放弃/" class="nav-link">Markdown入门到放弃</a></li><li class="dropdown-subitem"><a href="/数据结构/" class="nav-link">数据结构</a></li><li class="dropdown-subitem"><a href="/复习题/" class="nav-link">复习题</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/设计模式/" class="nav-link">设计模式</a></div> <a href="https://github.com/linqin07/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring技术</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Spring/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/Spring-boot/" class="nav-link">Spring-boot</a></li><li class="dropdown-subitem"><a href="/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">mysql</a></li></ul></li><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link router-link-active">Linux</a></li></ul></li><li class="dropdown-item"><h4>Other</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Java学习/" class="nav-link">Java学习</a></li><li class="dropdown-subitem"><a href="/Markdown入门到放弃/" class="nav-link">Markdown入门到放弃</a></li><li class="dropdown-subitem"><a href="/数据结构/" class="nav-link">数据结构</a></li><li class="dropdown-subitem"><a href="/复习题/" class="nav-link">复习题</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/设计模式/" class="nav-link">设计模式</a></div> <a href="https://github.com/linqin07/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Linux/" class="sidebar-link">README</a></li><li><a href="/Linux/SUMMARY.html" class="sidebar-link">SUMMARY</a></li><li><a href="/Linux/Deepin系统安装优化.html" class="sidebar-link">Deepin系统安装优化</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux/docker/1.简介安装.html" class="sidebar-link">1.简介安装</a></li><li><a href="/Linux/docker/2.Docker用法.html" class="active sidebar-link">2.Docker用法</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ELK</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Ftp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kafka</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux常用操作</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Linux/Prometheus监控.html" class="sidebar-link">Prometheus监控</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shell</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>zookeeper</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开机关机</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Linux/梯子.html" class="sidebar-link">梯子</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>系统操作</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="_1-设置docker加速、运行http访问、远程访问"><a href="#_1-设置docker加速、运行http访问、远程访问" aria-hidden="true" class="header-anchor">#</a> 1.设置docker加速、运行http访问、远程访问</h3> <p>Docker 安装成功之后，我们首先需要修改 Docker 配置，开启允许远程访问 Docker 的功能，开启方式很简单，修改 /usr/lib/systemd/system/docker.service 文件，加入如下内容：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>-H tcp://0.0.0.0:2375  -H unix:///var/run/docker.sock
</code></pre></div><p>编辑配置 <code>/etc/docker/daemon.json</code> https://docker.mirrors.ustc.edu.cn 是中国科学技术大学的docker仓库加速器，好像是实时代理的，但是时好时坏，生产环境一定要加 graph 选项，指定 docker 镜像和日志的目录为大空间的目录。启用 live-restore 设置来保持容器当 daemon 变为不可用时继续运行，默认是关闭的。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http://hub-mirror.c.163.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://pee6w651.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
	<span class="token property">&quot;graph&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/opt/data/docker&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;live-restore&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>设置运行http访问，docker 1.3.0 后面默认https，没办法虚拟机跑就很烦，换为自己的 ip 端口</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;192.168.85.128:5000&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><p>重载配置，重启</p> <p>systemctl daemon-reload</p> <p>systemctl restart docker</p> <h3 id="_2-搭建私服"><a href="#_2-搭建私服" aria-hidden="true" class="header-anchor">#</a> 2.搭建私服</h3> <p>使用 nexus3.x 比较方便</p> <p><a href="https://yeasy.gitbook.io/docker_practice/repository/nexus3_registry" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>docker run -d --name nexus3 --restart=always  -p 8081:8081 -p 8082:8082 -p 8083:8083 -p 8084:8084 --mount src=nexus-data,target=/nexus-data aab1398bb647</p> <p>再修改http可以访问。</p> <h3 id="_2-镜像操作"><a href="#_2-镜像操作" aria-hidden="true" class="header-anchor">#</a> 2.镜像操作</h3> <p>查看本地镜像: <code>docker images</code></p> <p>查找仓库镜像:  <code>docker search</code> [name]</p> <table><thead><tr><th><strong>REPOSITORY</strong></th> <th><strong>TAG</strong></th> <th><strong>IMAGE ID</strong></th> <th><strong>CREATED</strong></th> <th><strong>SIZE</strong></th></tr></thead> <tbody><tr><td>镜像仓库用户名/镜像名称</td> <td>镜像版本标签 latest表示最新版</td> <td>镜像唯一ID</td> <td>创建时间</td> <td>镜像文件大小</td></tr> <tr><td>docker.io</td> <td>docker.io/nginx</td> <td>Official build of Nginx.</td> <td>14378</td> <td>[OK]</td></tr></tbody></table> <p>获取仓库镜像: <code>docker pull</code> [镜像名称:版本]</p> <p>创建镜像标签: <code>docker tag</code> [镜像ID/镜像名称] [Tag内容]</p> <p>删除镜像: <code>docker rmi</code> [镜像名称/镜像ID/镜像Tag标签]</p> <p>如有运行容器，可以强制删除: docker rmi <code>-f</code> [镜像名称/镜像ID/镜像Tag标签]</p> <h3 id="_3-容器操作"><a href="#_3-容器操作" aria-hidden="true" class="header-anchor">#</a> 3.容器操作</h3> <p>创建容器: <code>docker create -p 3000:80 --name mynginx docker.io/nginx</code></p> <ul><li><p>-p 3000: 80 宿主机 3000 端口映射容器 80 端口</p></li> <li><p><code>--name</code> 指定名称</p></li></ul> <p>查询容器: docker ps -a</p> <p>全量查询:<code>docker ps --no-trunc</code></p> <p>删除容器: docker rm [name]</p> <p>删除容器并且显示删除映射的数据卷: docker rm -v [name]</p> <p>删除所有停止的容器: <code>docker rm $(docker ps -a -q)</code></p> <p>进入容器交互模式的终端: <code>docker exec -it mynginx [/bin/sh|bash]</code> [command]</p> <ul><li>-d :分离模式: 在后台运行</li> <li>-i :即使没有附加也保持STDIN 打开</li> <li>-t :分配一个伪终端</li></ul> <p>启停容器: <code>docker start/stop/restart</code> container_name/container_id</p> <p>查看容器运行日志: <code>docker logs</code> container_name/container_id</p> <p>查看容器数据卷映射:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker inspect -f <span class="token punctuation">{</span><span class="token punctuation">{</span>.Mounts<span class="token punctuation">}</span><span class="token punctuation">}</span> mynginx
</code></pre></div><h4 id="容器导入导出"><a href="#容器导入导出" aria-hidden="true" class="header-anchor">#</a> 容器导入导出</h4> <ul><li><p>export</p> <p>Usage:  docker export [OPTIONS] CONTAINER</p> <p>Export a container's filesystem as a tar archive</p> <p>Options:
-o, --output string   Write to a file, instead of STD</p> <p><code>docker export -o mynginx.tar ecc7500d8f2e</code></p></li> <li><p>import</p> <p>Usage:  docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]</p> <p>Import the contents from a tarball to create a filesystem image</p> <p><code>docker import mynginx.tar nginx/mynginx:v1</code></p></li></ul> <blockquote><p>执行导入的镜像报错 docker: Error response from daemon: No command specified.</p> <p>解决：查看导出的容器运行的命令，追加到运行命令后面即可。使用命令<code>docker ps --no-trunc</code>可以查看完整的容器运行命令。最终运行命令 <code>docker run --name nginx01 -d -v /data/nginx/html:/usr/share/nginx/html -v /data/nginx/log/nginx:/var/log/nginx -p 8090:80 c07e13de2ee4 /docker-entrypoint.sh nginx -g 'daemon off;'</code></p></blockquote> <h3 id="_4-容器运行"><a href="#_4-容器运行" aria-hidden="true" class="header-anchor">#</a> 4.容器运行</h3> <p>可以直接创建容器并运行 docker run  [image]</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker run 
--name nginx 
-d 
-v /data/nginx/html:/usr/share/nginx/html 
-v  /data/nginx/log/nginx:/var/log/nginx 
-p <span class="token number">8080</span>:80 
nginx
</code></pre></div><p><code>--rm</code> 停止就删除掉</p> <p><code>-d</code> 后台运行</p> <p><code>--name</code> 指定容器名称</p> <p><code>-v</code> 数据卷挂载目录: [宿主机目录:容器目录]</p> <p>容器目录不存在会自动创建，映射目录会自动双向同步。创建数据卷 <code>-v [数据卷名称]</code></p> <p><code>-p</code> 端口映射:[宿主机端口:容器端口]</p> <p><code>-P</code>随机端口</p> <p><code>--privileged=true</code> 使用该参数，容器内的root拥有真正的root权限.否则，容器内的root只是外部的一个普通用户权限。</p> <p><code>--restart=awaly</code> 随着容器重启，除非手动关掉了</p> <h3 id="更新容器参数"><a href="#更新容器参数" aria-hidden="true" class="header-anchor">#</a> 更新容器参数</h3> <p>要为容器配置重启策略，请在使用 docker run 命令时使用 --restart 标志。--restart 标志的值可以是以下任何一种：</p> <blockquote><p><code>no</code> 不要自动重启容器。（默认）</p> <p><code>on-failure</code> 如果容器因错误退出，则重新启动容器，这表现为非零退出代码。</p> <p><code>always</code> 如果容器停止，请始终重新启动容器。如果是手动停止的，只有在 Docker daemon 重启或者容器本身手动重启时才会重启。</p> <p><code>unless-stopped</code> 与 类似<code>always</code>，除了当容器停止（手动或其他方式）时，即使在 Docker 守护进程重新启动后也不会重新启动。</p></blockquote> <p>以下示例启动 Redis 容器并将其配置为始终重新启动，除非它被显式停止或 Docker 重新启动。</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker run -d --restart unless-stopped redis
</code></pre></div><p>此命令更改已在运行的名为 redis 的容器的重启策略。</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker update --restart unless-stopped redis
</code></pre></div><p>此命令将确保所有当前正在运行的容器将重新启动，除非停止。</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker update --restart unless-stopped $(docker ps -q)
</code></pre></div><h3 id="_5-文件拷贝"><a href="#_5-文件拷贝" aria-hidden="true" class="header-anchor">#</a> 5.文件拷贝</h3> <p>从主机复制到容器 <code>sudo docker cp host_path containerID:container_path</code></p> <p>从容器复制到主机 <code>sudo docker cp containerID:container_path host_path</code></p> <h3 id="_6-数据卷容器"><a href="#_6-数据卷容器" aria-hidden="true" class="header-anchor">#</a> 6.数据卷容器</h3> <p>数据卷容器（Data Volume Containers）：使用特定容器维护数据卷。从名称上可以看出数据卷容器本质上是一个容器，只不过这个容器专门提供数据卷给其他容器使用，即可以实现不同容器之间数据的同步。</p> <p>创建数据卷容器，注意 bash 形式是直接运行，exit 就退出了。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker run -it --name <span class="token builtin class-name">test</span> -v /data nginx <span class="token function">bash</span>
</code></pre></div><p>然后创建使用数据卷容器的容器。</p> <p>命令格式：<strong>docker run [容器启动参数] --volumes-from [数据卷容器名称] --name [当前容器名称] [当前容器镜像] [bash]</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker run -it --volumes-from <span class="token builtin class-name">test</span> --name test1 nginx <span class="token function">bash</span>
</code></pre></div><p>如果删除了挂载的容器（包括dbdata、db1和db2），数据卷并不会被自动删除。如果要删除一个数据卷，必须在删除最后一个还挂载着它的容器时显式使用<code>docker rm -v</code>命令来指定同时删除关联的容器。</p> <h4 id="数据卷迁移"><a href="#数据卷迁移" aria-hidden="true" class="header-anchor">#</a> 数据卷迁移</h4> <ul><li>备份</li></ul> <p>命令：<strong>docker run --volumes-from [要备份的数据卷容器名称] -v [宿主机目录]:[当前容器数据卷目录] --name [当前容器名称] --privileged=true [当前容器镜像] tar -cvPf [备份文件保存的目录]  [需要备份的数据卷]</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code> docker run  --volumes-from <span class="token builtin class-name">test</span> -v <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/backup --name test3 nginx <span class="token function">tar</span> -cvPf /backup/backup.tar /data
</code></pre></div><p>上述命令表示新运行一个容器，使用 test 数据卷容器，同时映射当前目录 (/data/backup) 到容器里面 /backup 目录，--name 容器命名为 test3，使用 nginx 镜像，执行打包操作 -P 参数表示使用绝对路径，生成 /backup/backup.tar 压缩包，备份数据卷 /data 目录。</p> <ul><li><p>恢复</p> <p>解压对应的 tar 包，tar -xvPf backup.tar 解压完成把解压文件放到对应的共享数据卷里面即可。</p></li></ul> <h3 id="_7-容器端口通讯"><a href="#_7-容器端口通讯" aria-hidden="true" class="header-anchor">#</a> 7.容器端口通讯</h3> <p>容器端口已经被映射了，不同容器直接想要通讯</p> <h3 id="_8-dockerfile"><a href="#_8-dockerfile" aria-hidden="true" class="header-anchor">#</a> 8.Dockerfile</h3> <p>Dockerfile用大白话解释就是一个配置文件，里面有各种命令，可用来构建自定义Docker镜像。作用好比如Maven的pom文件一样，可依据设置的指令执行相关的动作。</p> <table><thead><tr><th><strong>部分</strong></th> <th><strong>命令</strong></th></tr></thead> <tbody><tr><td>基础镜像信息</td> <td>FROM</td></tr> <tr><td>标签、维护者信息</td> <td>LABEL、MAINTAINER</td></tr> <tr><td>镜像操作指令</td> <td>RUN、COPY、ADD、EXPOSE、WORKDIR、ONBUILD、USER、VOLUME等</td></tr> <tr><td>容器启动时执行指令</td> <td>CMD、ENTRYPOINT</td></tr></tbody></table> <h4 id="命令详解"><a href="#命令详解" aria-hidden="true" class="header-anchor">#</a> 命令详解</h4> <ol><li><p>FROM</p> <p>指定基础镜像，如 FROM java:8</p></li> <li><p>LABEL</p> <p>设置标签信息，可用来设置自定义镜像的一些基本信息等</p> <p>LABEL version=&quot;1.0&quot;</p> <p>LABEL description=&quot;this is a SpringBoot app&quot;</p></li> <li><p>MAINTAINER</p> <p>设置作者信息</p> <p>MAINTAINER linqin woshilinqin163@163.com</p></li> <li><p>RUN</p> <p>在镜像内部执行的命令，可用来执行一些配置、设置环境、设置域名等</p> <p>RUN echo 'this is a restful app!' &gt; README.txt</p> <p>RUN echo &quot;172.31.3.25 autoconf.openspeech.cn&quot; &gt;&gt; /etc/hosts</p></li> <li><p>COPY</p> <p>将所在主机中的文件复制到容器内，比如我们需要运行某个Java应用，那么在生成自定义镜像的时候得先将，这个应用文件集成到镜像中</p> <p>如果是目录，复制<code>目录里面的内容</code>到容器，如果容器目录不存在会<code>自动创建</code>。</p> <p>COPY  vpa-page  /usr/share/nginx/html/vpa-page</p></li> <li><p>ADD</p> <p>使用和作用同COPY，但是不同的地方在于ADD会对压缩文件（tar, gzip, bzip2, etc）做提取和解压操作</p></li> <li><p>EXPOSE</p> <p>暴露镜像端口，需要注意的是这边暴露的端口并不意味着在宿主机中可以直接根据这个端口访问，同样的需要在容器启动的时候通过<code>-p</code>参数设置宿主机端口映射，或者 <code>-P</code>随机端口映射</p> <p>EXPOSE $POSR</p></li> <li><p>WORKDIR</p> <p>指定工作目录，后续命令操作都是基于此目录</p> <p>WORKDIR $WOEK_DIR</p></li> <li><p>USER</p> <p>指定容器启动后以哪个用户身份去运行</p> <p>USER ROOT</p></li> <li><p>VOLUME</p> <p>挂载容器数据卷，即将宿主机器某个目录和容器中某个目录进行映射，主要用来存放数据。</p> <p>添加数据卷，注意这里是无法指定宿主机器目录的。这里设置容器中当前工作目录下的 log 目录为数据卷，那么后期容器实际运行的时候这个下面的文件会实时同步到对应的随机分配的宿主机映射目录中。</p> <p>VOLUME $WORK_DIR/log</p></li> <li><p>CMD |  ENTRYPOINT</p> <p>容器启动的时候执行的命令，相当于在定义镜像的时候就约定好了运行容器后执行的命令，当有多个CMD的时候，只有最后一个生效。用户启动容器时候指定了运行的命令，则会覆盖掉 CMD 指定的命令，ENTRYPOINT 不会覆盖。</p> <p>CMD java -jar $WORK_DIR/xxx.jar</p></li></ol> <p><strong>案例:</strong></p> <p>新建dockerfile文件：touch dockerfile 、vim dockerfile，注意文件名称必须是dockerfile</p> <div class="language-dockerfile extra-class"><pre class="language-text"><code>#Dockerfile文件:自定义 Docker 镜像文件
#声明需要用到的基础镜像
FROM java:8
#声明基础信息
LABEL version=&quot;1.0&quot;
LABEL description=&quot;This is a SpringBoot test app&quot;
#声明作者信息
MAINTAINER linqin linqin_07@aliyun.com 
#声明环境变量
ENV WORK_DIR=/app PORT=8080
#声明工作目录
WORKDIR $WORK_DIR
#在镜像内部执行一些配置命令
RUN echo 'This is a test app !'&gt; README.txt
#将要运行的Java应用复制到镜像内
COPY spring-boot-test-0.0.1-SNAPSHOT.jar $WORK_DIR/spring-boot-test-0.0.1-SNAPSHOT.jar
#暴露镜像端口:这里为应用的访问端口
EXPOSE $PORT
#添加数据卷:这里将日志文件目录添加为数据卷(注意是无法指定宿主机目录的)
VOLUME $WORK_DIR/logs
#设置容器启动命令:即启动Java应用
CMD java -jar $WORK_DIR/spring-boot-test-0.0.1-SNAPSHOT.jar
</code></pre></div><p>执行命令生成镜像 -f 命令指定使用其他目录 Dockerfile
docker build -t name:tag .</p> <p>执行生成镜像命令</p> <div class="language-sh extra-class"><pre class="language-sh"><code> docker build -t spring-boot-test.jar <span class="token builtin class-name">.</span>
 
Sending build context to Docker daemon  <span class="token number">1</span>.379GB
Step <span class="token number">1</span>/11 <span class="token builtin class-name">:</span> FROM java:8
<span class="token number">8</span>: Pulling from library/java
5040bd298390: Pull complete 
fce5728aad85: Pull complete 
76610ec20bf5: Pull complete 
60170fec2151: Pull complete 
e98f73de8f0d: Pull complete 
11f7af24ed9c: Pull complete 
49e2d6393f32: Pull complete 
bb9cdec9c7f3: Pull complete 
Digest: sha256:c1ff613e8ba25833d2e1940da0940c3824f03f802c449f3d1815a66b7f8c0e9d
Status: Downloaded newer image <span class="token keyword">for</span> java:8
 ---<span class="token operator">&gt;</span> d23bdf5b1b1b
Step <span class="token number">2</span>/11 <span class="token builtin class-name">:</span> LABEL <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> fd6007d24044
Removing intermediate container fd6007d24044
 ---<span class="token operator">&gt;</span> 5743ec2d1bb3
Step <span class="token number">3</span>/11 <span class="token builtin class-name">:</span> LABEL <span class="token assign-left variable">description</span><span class="token operator">=</span><span class="token string">&quot;This is a SpringBoot test app&quot;</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> ff5c1a782b17
Removing intermediate container ff5c1a782b17
 ---<span class="token operator">&gt;</span> d96ea2194e36
Step <span class="token number">4</span>/11 <span class="token builtin class-name">:</span> MAINTAINER linqin linqin_07@aliyun.com
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> b88acdfff8d8
Removing intermediate container b88acdfff8d8
 ---<span class="token operator">&gt;</span> 71ec80304a33
Step <span class="token number">5</span>/11 <span class="token builtin class-name">:</span> ENV <span class="token assign-left variable">WORK_DIR</span><span class="token operator">=</span>/app <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">8080</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 7c19d3083dff
Removing intermediate container 7c19d3083dff
 ---<span class="token operator">&gt;</span> 09139b9a3b5f
Step <span class="token number">6</span>/11 <span class="token builtin class-name">:</span> WORKDIR <span class="token variable">$WORK_DIR</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 5ec9bafe6203
Removing intermediate container 5ec9bafe6203
 ---<span class="token operator">&gt;</span> fca757b40019
Step <span class="token number">7</span>/11 <span class="token builtin class-name">:</span> RUN <span class="token builtin class-name">echo</span> <span class="token string">'This is a test app !'</span><span class="token operator">&gt;</span> README.txt
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> d0da4bde9edf
Removing intermediate container d0da4bde9edf
 ---<span class="token operator">&gt;</span> 5d4cf880d3fa
Step <span class="token number">8</span>/11 <span class="token builtin class-name">:</span> COPY spring-boot-test-0.0.1-SNAPSHOT.jar <span class="token variable">$WORK_DIR</span>/spring-boot-test-0.0.1-SNAPSHOT.jar
 ---<span class="token operator">&gt;</span> f9621fe4ca36
Step <span class="token number">9</span>/11 <span class="token builtin class-name">:</span> EXPOSE <span class="token variable">$PORT</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> a5f6010b1f0f
Removing intermediate container a5f6010b1f0f
 ---<span class="token operator">&gt;</span> a1606933767d
Step <span class="token number">10</span>/11 <span class="token builtin class-name">:</span> VOLUME <span class="token variable">$WORK_DIR</span>/logs
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> c2909474a96b
Removing intermediate container c2909474a96b
 ---<span class="token operator">&gt;</span> d04bf50acb7f
Step <span class="token number">11</span>/11 <span class="token builtin class-name">:</span> CMD java -jar <span class="token variable">$WORK_DIR</span>/spring-boot-test-0.0.1-SNAPSHOT.jar
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 569f354af7e8
Removing intermediate container 569f354af7e8
 ---<span class="token operator">&gt;</span> f92d928f8145
Successfully built f92d928f8145
Successfully tagged spring-boot-test.jar:latest
</code></pre></div><p>这样生成的镜像就可以使用<code>docker images</code>查看</p> <p>运行该镜像</p> <h3 id="个人理解"><a href="#个人理解" aria-hidden="true" class="header-anchor">#</a> 个人理解</h3> <p>docker 有点是可以很快速的启动一些应用，不用担心环境问题。但是具体使用时尽量避免映射过多的路径，这样就失去了 docker 的本意，可以采取进入容器的方式进行管理。缺点是如果要具体对应用进行调优，这将是非常麻烦的事情。</p> <p>but，集成k8s后，真香！！！</p> <h3 id="docker-compose"><a href="#docker-compose" aria-hidden="true" class="header-anchor">#</a> docker-compose</h3> <p>作用容器编排</p> <h4 id="安装"><a href="#安装" aria-hidden="true" class="header-anchor">#</a> 安装</h4> <p>若是github访问太慢，可以用daocloud下载</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">curl</span> -L https://get.daocloud.io/docker/compose/releases/download/1.25.1/docker-compose-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -s<span class="token variable">`</span></span>-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -m<span class="token variable">`</span></span> -o /usr/local/bin/docker-compose
</code></pre></div><p>添加可执行权限
sudo chmod +x /usr/local/bin/docker-compose
测试安装结果
$ docker-compose -v</p> <h4 id="docker-compose常用命令"><a href="#docker-compose常用命令" aria-hidden="true" class="header-anchor">#</a> docker-compose常用命令</h4> <ul><li>1、docker-compose ps 查询当前启动的服务</li> <li>2、docker-compose up -d [service]  启动编排号的服务</li> <li>3、docker-compose stop [service] 停止服务</li> <li>4、docker-compose restart [service] 重启服务</li> <li>5、docker-compose rm 删除服务容器</li> <li>6、【-f docker-compose-*.yml】指定自定义的yml文件例如，docker-compose -f docker-compose-1.yml up -d 启动docker-compose-1.yml</li> <li>7.删除service[同时会删除掉network和volume]
docker-compose down</li> <li>进入到某个service，bash更好用
docker-compose exec [service] [sh|bash]</li></ul> <h4 id="新建文件-docker-compose-yml"><a href="#新建文件-docker-compose-yml" aria-hidden="true" class="header-anchor">#</a> 新建文件 docker-compose.yml</h4> <p>默认在这个文件下面执行命令，否则需要 <code>-f</code>参数指定</p> <div class="language-sh extra-class"><pre class="language-sh"><code>version: <span class="token string">'3'</span>
services:
  vpa-eureka-server:
    image: java
    restart: <span class="token string">&quot;always&quot;</span> <span class="token comment">#重启策略，能够使服务保持始终运行，生产环境推荐使用</span>
    container_name: <span class="token variable">${env}</span>-vpa-eureka-server <span class="token comment">#容器名称</span>
    volumes:
      - /opt/vpa/jar/vpa-eureka-server-0.0.1-SNAPSHOT.jar:/usr/vpa-eureka-server.jar
    network_mode: <span class="token string">&quot;host&quot;</span>
    ports:
      - <span class="token number">8761</span>:8761
    entrypoint: java -jar -Xms1g -Xmx1g /usr/vpa-eureka-server.jar --spring.profiles.active<span class="token operator">=</span><span class="token variable">${env}</span>
    environment:
      - <span class="token assign-left variable">TZ</span><span class="token operator">=</span>Asia/Shanghai
    labels:
      - <span class="token string">&quot;servicename=vpa-eureka-server&quot;</span>  <span class="token comment">#设置名称，默认是容器名称</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">2023/11/22 08:04:12</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Linux/docker/1.简介安装.html" class="prev">1.简介安装</a></span> <span class="next"><a href="/Linux/ELK/">README</a>→
    </span></p></div> </main></div><div class="global-ui"><!----><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2dcanvas" width="135" height="300" class="live2dcanvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.8835c5f3.js" defer></script><script src="/assets/js/3.f34275aa.js" defer></script><script src="/assets/js/98.bc5c7835.js" defer></script><script src="/assets/js/4.886c8c49.js" defer></script>
  </body>
</html>
